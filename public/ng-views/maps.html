<!-- progress bar -->
<div class="progress" ng-show="loadProgress.vis">
  <div class="progress-bar progress-bar-info progress-bar-striped active" 
        role="progressbar"  id="isosProgressBar"
        style="width:{{loadProgress.val}}%">
  </div>
</div>

<!-- hamburger menu topleft -->
<div class="topnav">
  <div class="fa-stack" ng-click="managerView=true">
    <i class="fa fa-stop fa-stack-2x"></i>
    <i class="fa fa-bars fa-stack-1x fa-inverse"></i>
  </div>

  <div class="legend">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h6 class="panel-title" ng-click="scenarioLegend=!scenarioLegend">
          Legend
          <i class="fa fa-expand pull-right"></i>
        </h6>
      </div>
      <div class="panel-body" ng-show="scenarioLegend && showVectorIsosOn">
        Time Boundary
        <br><i class="fa fa-stop" style="color:#FDB813"></i> <small>{{ combos.all[combos.sel].name }}</small>
        <br><i class="fa fa-stop" style="color:#89cff0"></i> <small>{{ combos.all[combos.com].name }}</small>
      </div>
      <div class="panel-body" ng-show="scenarioLegend && !showVectorIsosOn && !scenarioCompare ">
        Travel Time
        <br><i class="fa fa-stop" style="color:#FDB813"></i> <small>Shorter</small>
        <br><i class="fa fa-stop" style="color:#FEEDC2"></i> <small>Longer</small>
        <br><i class="fa fa-stop" style="color:#FFF"></i> <small>Unreachable</small>
      </div>  
	  <div class="panel-body" ng-show="scenarioLegend && !showVectorIsosOn && scenarioCompare ">
		Travel Time
        <br><i class="fa fa-stop" style="color:#FDB813"></i> <small>No Difference</small>
        <br><i class="fa fa-stop" style="color:#FEEDC2"></i> <small>No Difference</small>
		<br><i class="fa fa-stop" style="color:#9651d5"></i> <small>{{ combos.all[combos.sel].name }} Much Shorter</small>
        <br><i class="fa fa-stop" style="color:#e4d3f4"></i> <small>{{ combos.all[combos.sel].name }} Shorter</small>
      </div>
    </div>
  </div>
</div>



<!-- upper views -->

<div class="topcol">


  <div class="topleft" style="background-color:#216C2A" ng-show="scenarioScorecard">
    <h4>
      Scenario Scorecard
      <i class="fa fa-times-circle-o pull-right" ng-click="scenarioScorecard = false"></i>
    </h4>
    <div class="topinfo-body container" style="min-height:250px">

      <div class="pull-left" style="width: 100%; padding-right: 310px;">
        <div class="row">
          <div class="col-xs-5">
            <h3>
              <i class="fa fa-dot-circle-o"></i> {{ scenarioScore.bus.count }}
              <h6>Bus Stops</h6>
            </h3>
          </div>
          <div class="col-xs-6">
            <h3>
              <i class="fa fa-usd"></i> {{ scenarioScore.bus.cost/1000000 | number:2 }}M
              <h6>All Stations</h6>
            </h3>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-5">
            <h3>
              <i class="fa fa-road"></i> {{ scenarioScore.length.count | number:1 }}
              <h6>Miles</h6>
            </h3>
          </div>
          <div class="col-xs-6">
            <h3>
              <i class="fa fa-usd"></i> {{ scenarioScore.length.cost/1000000 | number:2 }}M
              <h6>All Lanes</h6>
            </h3>
          </div>
        </div>

        <div class="row">
          <div class="col-xs-5">
            <h3>
              <i class="fa fa-bus"></i> {{ scenarioScore.vehicles.count }}
              <h6>Vehicles</h6>
            </h3>
          </div>
          <div class="col-xs-6">
            <h3>
              <i class="fa fa-usd"></i> {{ scenarioScore.vehicles.cost/1000000 | number:2 }}M
              <h6>Operations</h6>
            </h3>
          </div>
        </div>
      </div>

      <div style="height: 250px; position: absolute; right: 0px">
        <svg id="compPlot" width="350" height="200"></svg>
        <center>

          <div class="btn-group" dropdown>
            <button id="split-button" type="button" class="btn btn-success"
                    ng-click="drawGraph(scenarioScore.graphData)">
              Show with {{ scenarioScore.graphData.sel.verbose }}
            </button>
            <button type="button" class="btn btn-success" dropdown-toggle>
              <span class="caret"></span>
              <span class="sr-only">Split button!</span>
            </button>
            <ul class="dropdown-menu" role="menu">
              <li ng-repeat="(id, dataVal) in scenarioScore.graphData.all" 
                  ng-click="selectGraphData(dataVal)"
                  value="{{ id }}">
                <a href="">{{ dataVal.verbose }}</a>
              </li>
            </ul>
          </div>
        </center>
      </div>
    </div>
  </div>

  <div class="topleft topinfo" ng-show="managerView">
    <h4>
      <i class="fa fa-cog fa-spin" ng-if="managerOperations"></i> Manager Controls
      <i class="fa fa-times-circle-o pull-right" ng-click="managerView=false"></i>
    </h4>
    <div class="topinfo-body container">
      <h6>
        Click to auto create baseline and gold standard scenarios. <span class="badge" ng-click="buildScenarios()">Run Create</span>
      </h6>
      <h6>
        Current sensitivity level is: {{ sensitivity | number: 2 }} miles. 
        <span class="badge" ng-click="sensitivity = sensitivity - 0.05">Decrease</span>
        <span class="badge" ng-click="sensitivity = sensitivity + 0.05">Increase</span>
      </h6>
      <h6>
        You currently have selected this JSON cache: 
        <div class="btn-group" dropdown>
          <button type="button" class="btn btn-default btn-xs">
            {{ snapPoints.sel }}
          </button>
          <button type="button" class="btn btn-default btn-xs" dropdown-toggle>
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li ng-repeat="id in snapPoints.all" 
                ng-click="setNewSnapCache(id)"
                value="{{ id }}">
              <a href="">{{ id }}</a>
            </li>
          </ul>
        </div>
      </h6>
      <h6>
        Click to auto sync preloaded GeoJSON data with spreadsheet. <span class="badge" ng-click="updateLocationCache(snapPoints.sel)">Run AutoSync</span>
      </h6>
      <h6>
        Download session footprint. <span class="badge" ng-click="downloadSession()">Download</span>
      </h6>
	  	<h6>
        Basemap (Left): <span class="badge" ng-click="changeTilesLeft('blank')">Basic</span>
    		<span class="badge" ng-click="changeTilesLeft('base')">Neighborhoods and Parks</span>
    		<span class="badge" ng-click="changeTilesLeft('collisions')">Crash Hotspots</span>
      </h6>
      <h6>
        Basemap (Right): <span class="badge" ng-click="changeTilesRight('blank')">Basic</span>
    		<span class="badge" ng-click="changeTilesRight('base')">Neighborhoods and Parks</span>
    		<span class="badge" ng-click="changeTilesRight('collisions')">Crash Hotspots</span>
      </h6>
      <h6>
        Cache current scenario. <span class="badge" ng-click="saveScenarioCache()">Run Caching</span>
      </h6>
    </div>
  </div>
</div>

<div class="topcol right">
  <div class="topleft" style="background-color:#216C2A" ng-show="routeScorecard" >
    <h4>
      Route Scorecard
      <i class="fa fa-times-circle-o pull-right" ng-click="routeScorecard=false"></i>
    </h4>
    <div class="topinfo-body container">

      <div class="row">
        <div class="col-xs-3">
          <h2>
            <i class="fa fa-dot-circle-o"></i> {{ routeScore.bus.count }}
            <h6>Bus Stops</h6>
          </h2>
        </div>
        <div class="col-xs-4">
          <h5>
            <b>Standard:</b> {{ routeScore.bus.dist[0] | convertPercentage | number:0 }}%
          </h5>
          <h5>
            <b>Platform:</b> {{ routeScore.bus.dist[1] | convertPercentage | number:0 }}%
          </h5>
          <h5>
            <b>BRT Station:</b> {{ routeScore.bus.dist[2] | convertPercentage | number:0 }}%
          </h5>
        </div>
        <div class="col-xs-5">
          <h2>
            <i class="fa fa-usd"></i> {{ routeScore.bus.cost | number:0 }}
            <h6>Cost of stations construction</h6>
          </h2>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-3">
          <h2>
            <i class="fa fa-road"></i> {{ routeScore.length.count | number:1 }}
            <h6>Miles Round-Trip</h6>
          </h2>
        </div>
        <div class="col-xs-4">
          <br>
          <h5>
            <b>Non-dedicated:</b> {{ routeScore.length.dist.non | convertPercentage | number:0 }}%
          </h5>
          <h5>
            <b>Dedicated:</b> {{ routeScore.length.dist.ded | convertPercentage | number:0 }}%
          </h5>
        </div>
        <div class="col-xs-5">
          <h2>
            <i class="fa fa-usd"></i> {{ routeScore.length.cost | number:0 }}
            <h6>Dedicated lane construction</h6>
          </h2>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-3">
          <h2>
            <i class="fa fa-clock-o"></i> {{ routeScore.time.count | minuteConverter }}
            <h6>Peak Round-Trip</h6>
          </h2>
        </div>
        <div class="col-xs-4">
          <br>
          <h5>
            <b>Moving:</b> {{ routeScore.time.dist.move | convertPercentage | number:0 }}%
          </h5>
          <h5>
            <b>Loading:</b> {{ routeScore.time.dist.load | convertPercentage | number:0 }}%
          </h5>
        </div>
        <div class="col-xs-5">
        </div>
      </div>

      <div class="row">
        <div class="col-xs-3">
          <h2>
            <i class="fa fa-bus"></i> {{ routeScore.vehicles.count }}
            <h6>Vehicles</h6>
          </h2>
        </div>
        <div class="col-xs-4">
        </div>
        <div class="col-xs-5">
          <h2>
            <i class="fa fa-usd"></i> {{ routeScore.vehicles.cost | number:0 }}
            <h6>Annual Cost of Operations</h6>
          </h2>
        </div>
      </div>
    </div>
  </div>


  <!--ROUTE INFO PROMPT-->

  <div class="topleft" style="background-color: #{{ targetFeature.properties.routeColor }}" ng-show="routeDetails">
    <h4>
      {{ targetFeature.properties.varName }} Alignment
      <i class="fa fa-times-circle-o pull-right" ng-click="routeDetails=false"></i>
    </h4>
    <div class="topinfo-body container">
      <h6>
        Corridor: {{ targetFeature.properties.corLonName }} | Alignment: {{ targetFeature.properties.varName }} | Length: {{ targetFeature.properties.length | number:2 }} miles
      </h6>

      <h6 ng-show="targetFeature.alternatives">
        There are {{ targetFeature.alternatives.length/2 + variants[tabnav].length }} alignments for Corridor {{ targetFeature.properties.corName }}. Based on these alignments, {{ variants[tabnav].all | keyLength }} variations have been created this session: 
        <span ng-repeat="(key, variant) in variants[tabnav].all">
          <span class="badge"  style="color: #{{ targetFeature.properties.routeColor }}" 
                ng-click="updateTargetFeature(variant)">
            {{ variant.name }}
          </span>
        </span>
      </h6>
      
      <button class="btn btn-choose pull-right" type="button" 
              ng-show="scenario[tabnav].routeId !== targetFeature.properties.routeId"
              ng-click="scenario[targetFeature.properties.corName].routeId = targetFeature.properties.routeId;
                        createVar=true" 
              style="background-color: #{{ targetFeature.properties.routeColor }}">
        Use this path for the {{ targetFeature.properties.corLonName }} corridor
      </button>

      <button class="btn btn-choose pull-right" type="button" 
              ng-show="scenario[targetFeature.properties.corName].routeId == targetFeature.properties.routeId"
              style="background-color: #{{ targetFeature.properties.routeColor }}">
        <i class="fa fa-check"></i>
        Path selected
      </button>
    </div>
  </div>
</div>


<div class="bottomCol">
  <!--SAVE-ROUTE PROMPT-->
  <div class="saveVar" ng-show="saveAlt">
    <h4>
      Save new variation for Corridor {{ tabnav }}
      <i class="fa fa-times-circle-o pull-right" ng-click="saveAlt=false"></i>
    </h4>
    <div class="saveAlt-body container">
      <h6 ng-if="!scenario[tabnav].routeId"><i class="fa fa-level-down fa-2x fa-flip-horizontal" style="vertical-align:top; padding-right:10px" ></i> Select a parent variation from the <span class="col-head-button" ng-click="visibleTabs.routes = !visibleTabs.routes">   Corridor Editor   </span>.</h6>
	  <ol ng-if="scenario[tabnav].routeId">
	  <li>Make changes in the <span class="col-head-button" ng-click="visibleTabs.customize = !visibleTabs.customize">   Service Editor   </span> <span style="float:right; padding-left:10px" ng-click="visibleTabs.customize = !visibleTabs.customize"><i class="fa fa-level-down fa-2x" ></i>  </span><span style="float:right" ng-click="visibleTabs.customize = !visibleTabs.customize"> <i class="fa fa-pencil-square-o"></i></span></li>
	  <li>Review variation:
	  <h6 ng-if="scenario[tabnav].routeId">
        Corridor: {{ routes[scenario[tabnav].routeId][0].options.base.corLonName }} | Alignment: {{ routes[scenario[tabnav].routeId][0].options.base.varName }} 
      </h6>
      </h6>
      <h6>
        Station type: 
        <span ng-if="scenario[tabnav].station == 0">
          standard bus stops
        </span>
        <span ng-if="scenario[tabnav].station == 1">
          bus stops enhanced with raised platforms
        </span>
        <span ng-if="scenario[tabnav].station == 2">
          BRT bus stations that feature both raised platforms and preboarding fare purchasing
        </span>
        Peak frequencies along your alternative of Route {{ tabnav }} have been set to {{ scenario[tabnav].peak.min }}:{{ scenario[tabnav].peak.sec | integerLength }} between arrivals. Off-peak frequencies have been set to {{ scenario[tabnav].offpeak.min }}:{{ scenario[tabnav].offpeak.sec | integerLength }} between arrivals.
      </h6>
	  </li>
	  <li>Name variation and save 
      <div class="input-group">
        <input type="text" class="form-control" ng-model="scenario[tabnav].name" placeholder="Name variant for corridor {{ tabnav }}...">
        <span class="input-group-btn">
          <button class="btn btn-savealt" type="button" 
            ng-show="!scenario[tabnav].name" 
            style="cursor:not-allowed">
            Save Variation
          </button>
          <button class="btn btn-savealt" type="button" 
            ng-click="saveAlt=false; newVariant(tabnav, true)" 
            ng-show="scenario[tabnav].name && scenario[tabnav].routeId">
            Save Variation
          </button>
        </span>
      </div>
	  </li>
    </div>
  </div>

  <!--SAVE-SCENARIO PROMPT-->
  <div class="saveComb" ng-show="saveCombo">
    <h4>
      Save new combo
      <i class="fa fa-times-circle-o pull-right" ng-click="saveCombo=false"></i>
    </h4>
    <div class="saveAlt-body container">
      <ol>
	  <li>Activate variations in the <span class="col-head-button" ng-click="visibleTabs.routes = !visibleTabs.routes">   Corridor Editor   </span> <span style="float:right; padding-left:10px" ng-click="visibleTabs.routes = !visibleTabs.routes"><i class="fa fa-level-down fa-2x"></i>  </span><span style="float:right" ng-click="visibleTabs.routes = !visibleTabs.routes"> <i class="fa fa-code-fork fa-rotate-270"></i></span></li>
	  <li>Review combo:
      <h6 ng-repeat="(key, variant) in variants" ng-show="variant.sel">
        <b class="badge" style="color: #{{ routes[variant.all[variant.sel].routeId][0].options.base.routeColor }}">
          {{ variant.all[variant.sel].name }}: 
        </b>
        Station type: 
        <span ng-if="variant.all[variant.sel].station == 0">
          standard bus stop
        </span>
        <span ng-if="variant.all[variant.sel].station == 1">
          raised platform
        </span>
        <span ng-if="variant.all[variant.sel].station == 2">
          BRT station
        </span>
        | Average wait time: {{ variant.all[variant.sel].peak.min | avgWaitTime }} (peak), {{ variant.all[variant.sel].offpeak.min | avgWaitTime }} (off-peak)
      </h6>
	  </li>
	  <li>Name combo and save</li>
      <div class="input-group">
        <input type="text" class="form-control" ng-model="comboName" placeholder="Enter a name for this combo...">
        <span class="input-group-btn">
          <button class="btn btn-savealt" type="button" 
            ng-show="!comboName"
            style="cursor:not-allowed" disabled>
            Save Combo
          </button>
          <button class="btn btn-savealt" type="button" 
            ng-show="comboName"
            ng-click="newCombo(comboName); saveCombo=false">
            Save Combo
          </button>
        </span>
      </div>
    </div>
  </div>
</div>



<leaflet  center   = "center_left"
          defaults = "defaults_left"
          id       = "map_left"
          tiles    = "tiles_left"
          markers  = "markers_left"
		  maxbounds = "maxBounds_left"
          >
</leaflet>
<leaflet  center   = "center_right"
          defaults = "defaults_right"
          id       = "map_right"
          tiles    = "tiles_right"
          maxbounds = "maxBounds_right"
		  >
</leaflet>


<div style="position:absolute;right:50%;height:100%;width:0px;border-style:solid;border-color:#999;border-width:1px"></div>


<!-- 1 poi markers --> 
<div class="leftNav">
  <div class="badge" ng-class="!currentPOIUser ? '' : 'unselected'" ng-click="targetPOIUsers(user.userId)">
        <i class="fa fa-user"></i><br> All
  </div>
  <div class="badge" 
        ng-repeat="user in poiUsers track by $index" 
        ng-click="targetPOIUsers(user.userId)" 
        ng-class="user.userId == currentPOIUser ? '' : 'unselected'">
        <i class="fa fa-user"></i><br> {{ user.userId }}
  </div>
</div>


<div class="bottomNav">

  <!-- 2 destination and time filters --> 
  <div class="colBody" style="width:275px"> 
    <div class="colHead" ng-click="visibleTabs.travel = !visibleTabs.travel">
      <i class="fa fa-clock-o"></i> Time Map
    </div>

    <div class="placeHolder" ng-show="!visibleTabs.travel" ng-click="visibleTabs.travel = !visibleTabs.travel">
      <div class="bigText">
        <i class="fa fa-clock-o"></i>
      </div>
    </div>

    <div class="showToggle" ng-show="visibleTabs.travel">
      <div class="subHead" ng-click="toggleShowVectorIsos()">
        Show time boundaries
        <span ng-show="showVectorIsosOn">
          <i class="fa fa-eye"></i> On
        </span>
        <span ng-show="!showVectorIsosOn">
          <i class="fa fa-eye-slash"></i> Off
        </span>
      </div>

      <div style="width:100%; height:45px; overflow:hidden;padding-top:5px;">
        <div class="text-center" style="width:25px;height:35px;float:left;padding-bottom:5px;background-color:#31B0D5;opacity:0.5">
          <div class="fa fa-refresh fa-inverse" style="line-height:35px" ng-click="preMarkerQuery()"></div>
        </div>
        <div class="text-center" style="float:left; width: 250px; padding: 0px 8px 0px 8px">
          <span ng-class="showVectorIsosOn ? '' : 'unselected'" >
            <input type="range" min="1" max="24" class="isosRange"
              ng-model="vectorIsos.val"
              ng-disabled="!showVectorIsosOn"
              ng-click="showVectorIsos(300*vectorIsos.val)"/>
            <i class="fa fa-minus-square" ng-click="vectorTimeVal_subtract(); showVectorIsos(300*vectorIsos.val)"></i>
            {{ vectorIsos.val*5 | minuteConverter }} hours
            <i class="fa fa-plus-square" ng-click="vectorTimeVal_add(); showVectorIsos(300*vectorIsos.val)"></i>
          </span>
        </div>
      </div>


      <div class="subHead">Destinations</div>
      <div class="btn-group btn-group-justified">
        <label class="btn btn-xs"><i class="fa fa-briefcase"></i></label>
        <label class="btn btn-xs"><i class="fa fa-heartbeat"></i></label>
        <label class="btn btn-xs"><i class="fa fa-shopping-cart"></i></label>
        <label class="btn btn-xs"><i class="fa fa-graduation-cap"></i></label>
      </div>

      <div class="subHead">Mode</div>
      <div class="btn-group btn-group-justified">
        <label class="btn btn-xs" ng-class="mode.selected=='walk' ? 'active tiny' : ''"
                ng-click="mode.selected='walk'">
          <i class="fa fa-child"></i>
        </label>
        <label class="btn btn-xs" ng-class="mode.selected=='bus' ? 'active tiny' : ''"
                ng-click="mode.selected='bus'">
          <i class="fa fa-bus"></i>
        </label>
        <label class="btn btn-xs" ng-class="mode.selected=='local' ? 'active tiny' : ''"
                ng-click="mode.selected='local'">
          <i class="fa fa-train"></i>
        </label>
        <label class="btn btn-xs" ng-class="mode.selected=='all' ? 'active tiny' : ''"
                ng-click="mode.selected='all'">
          <i class="fa fa-ship"></i>
        </label>
      </div>
    </div>
  </div>


  <!-- 3 scenario table module --> 
  <div class="colBody" id="leftDynamic"> 
    <div class="colHead" ng-click="visibleTabs.scenarios = !visibleTabs.scenarios">
      <i class="fa fa-binoculars"></i>
      <span ng-show="!combos.sel">Existing MBTA System</span>
      <span ng-show="combos.sel">
        Scenario {{ combos.all[combos.sel].name }}
        <span ng-show="scenarioCompare">
          <span ng-show="combos.com">Compared with {{ combos.all[combos.com].name }}</span>
          <span ng-show="!combos.com">Compared with Baseline</span>
        </span>
      </span>
    </div>

    <div class="placeHolder" ng-show="!visibleTabs.scenarios" ng-click="visibleTabs.scenarios = !visibleTabs.scenarios">
      <div class="bigText">
        <i class="fa fa-binoculars"></i>
      </div>
    </div>

    <div class="showToggle" ng-show="visibleTabs.scenarios">

      <div class="scenariosTable" style="margin-top:-18px;padding-top:18px;">
        <div class="scenario" style="position:absolute;z-index:10;box-shadow:5px 0px 3px rgba(0,0,0,0.1);">
          <div>ID</div>
          <div class="square" style="background-color:#0071CA">BH</div>
          <div class="square" style="background-color:#B10086">HP</div>
          <div class="square" style="background-color:#CE5504">HD</div>
          <div class="square" style="background-color:#AD0101">SD</div>
          <div class="fa fa-arrows-h"></div>
        </div>

        <div style="margin-left:21px;height:100%;width:10000px;overflow-y:scroll;overflow-x:scroll;">
          
          <div class="scenario" style="display:inline-block;white-space:nowrap;"
                ng-class="combos.sel == variant._key ? 'selected' : ''"
                ng-repeat="variant in combos.all | toArray | orderBy:'created'">

            <div class="subHead">
              <span ng-show="combos.sel !== variant._key" 
                  ng-click="updateLeftRoutes(variant._key); combos.com=null;">
                <small>{{ variant.name }}</small>
              </span>
              <span ng-show="combos.sel == variant._key"
                  ng-click="updateLeftRoutes(); combos.com=null;">
                <small><b>{{ variant.name }}</b></small>
              </span>
            </div>
            <div>
              <span class="text-success" ng-show="variant.sel['BH']">
                <i class="fa fa-check"></i>
                <small><i>{{ variants['BH'].all[variant.sel['BH']].name }}</i></small>
              </span>
              <span class="text-danger" ng-show="!variant.sel['BH']">
                <i class="fa fa-times"></i>
                <small><i>None</i></small>
              </span>
            </div>
            <div>
              <span class="text-success" ng-show="variant.sel['HP']">
                <i class="fa fa-check"></i>
                <small><i>{{ variants['HP'].all[variant.sel['HP']].name }}</i></small>
              </span>
              <span class="text-danger" ng-show="!variant.sel['HP']">
                <i class="fa fa-times"></i>
                <small><i>None</i></small>
              </span>
            </div>
            <div>
              <span class="text-success" ng-show="variant.sel['HD']">
                <i class="fa fa-check"></i>
                <small><i>{{ variants['HD'].all[variant.sel['HD']].name }}</i></small>
              </span>
              <span class="text-danger" ng-show="!variant.sel['HD']">
                <i class="fa fa-times"></i>
                <small><i>None</i></small>
              </span>
            </div>
            <div>
              <span class="text-success" ng-show="variant.sel['CT']">
                <i class="fa fa-check"></i>
                <small><i>{{ variants['CT'].all[variant.sel['CT']].name }}</i></small>
              </span>
              <span class="text-danger" ng-show="!variant.sel['CT']">
                <i class="fa fa-times"></i>
                <small><i>None</i></small>
              </span>
            </div>


            <div class="text-center">
              <span ng-show="scenarioCompare && combos.sel !== variant._key">
                <i  class = "fa fa-circle-o" 
                    ng-show="combos.com !== variant._key" 
                    ng-click="combos.com=variant._key; $event.stopPropagation()"></i>
                <i  class = "fa fa-check-circle" 
                    ng-show="combos.com == variant._key"
                    ng-click="combos.com=null; $event.stopPropagation()"></i>
              </span>
              <span ng-show="scenarioCompare && combos.sel == variant._key">
                <i class="fa fa-ban"></i>
              </span>
            </div>

          </div>
        </div>
      </div>


      <div class="bottomFixed">
        <div class="subHead">
          <span class="pull-left"
                ng-click="scenarioScorecard = !scenarioScorecard; updateScenarioScorecard(combos.sel)">
                Scorecard
          </span>
          <span>
            <span ng-show="scenarioCompare" 
                  ng-click="scenarioCompare=false; combos.com=null">
                  Compare Scenarios <i class="fa fa-toggle-on"></i>
            </span>
            <span ng-show="!scenarioCompare" 
                  ng-click="scenarioCompare=true">
                  Compare Scenarios <i class="fa fa-toggle-off"></i>
            </span>
          </span>
          <span class="pull-right" ng-click="saveCombo=!saveCombo">
                New Scenario
          </span>
        </div>
      </div>

    </div>
  </div>


  <!-- 4 route selector module --> 
  <div class="colBody text-center" style="width:35px"> 
    <div class="colHead" ng-click="visibleTabs.routes = !visibleTabs.routes">
      <div class="fa-stack" ng-click="targetPOIUsers()">
        <i class="fa fa-bus"></i>
      </div>
    </div>
      
    <div class="showToggle" ng-show="visibleTabs.routes" style="background-color: rgba(255,165,0,0.5)">
      <div class="smallColVal" style="color:#FFF;background-color:#0071CA;"
            ng-click="targetCorridor('BH'); tabnav='BH'; overview=true"
            ng-class="tabnav !== 'BH' ? 'unselected' : ''">
            BH
      </div>

      <div class="smallColVal" style="color:#FFF;background-color:#B10086;"
            ng-click="targetCorridor('HP'); tabnav='HP'; overview=true"
            ng-class="tabnav !== 'HP' ? 'unselected' : ''">
            HP
      </div>

      <div class="smallColVal" style="color:#FFF;background-color:#CE5504;"
            ng-click="targetCorridor('HD'); tabnav='HD'; overview=true"
            ng-class="tabnav !== 'HD' ? 'unselected' : ''">
            HD
      </div>

      <div class="smallColVal" style="color:#FFF;background-color:#AD0101;"
            ng-click="targetCorridor('CT'); tabnav='CT'; overview=true"
            ng-class="tabnav !== 'CT' ? 'unselected' : ''">
            CT
      </div> 
    </div>
  </div>  


  <!-- 5 route table module --> 
  <div class="colBody" id="rightDynamic1">
    <div class="colHead" ng-click="visibleTabs.routes = !visibleTabs.routes">
      <span ng-show="variants[tabnav].sel">
        {{ routes[variants[tabnav].all[variants[tabnav].sel].routeId][0].options.base.corLonName }}: Corridor Editor
      </span>

      <span ng-show="!variants[tabnav].sel">
        <i class="fa fa-exclamation-triangle"></i> No path selected for {{ tabnav }} corridor
      </span>
    </div>

    <div class="placeHolder" ng-show="!visibleTabs.routes" ng-click="visibleTabs.routes = !visibleTabs.routes">
      <div class="bigText">
        <i class="fa fa-bus"></i>
      </div>
    </div>

    <div class="showToggle" ng-show="visibleTabs.routes">
      <div class="subHead" ng-show="variants[tabnav].sel"
            style="background-color: #{{ routes[variants[tabnav].all[variants[tabnav].sel].routeId][0].options.base.routeColor }};
                    padding-right: 5px"
            ng-click="updateRouteScorecard(scenario[tabnav].routeId, tabnav); routeScorecard=!routeScorecard">
        <span class="pull-right">
              View Scorecard
        </span>
        {{ variants[tabnav].all[variants[tabnav].sel].name }} selected.
      </div>

      <div class="subHead" ng-show="!variants[tabnav].sel">
        This route will be exluded from model right.
      </div>
    
      <div style="height: 100%; overflow-y: scroll">
        <table class="table table-condensed table-hover">
          <thead>
            <tr>
              <th><i class="fa fa-check-square"></i></th>
              <th>Name</th>
              <th>Station</th>
              <th>Peak</th>
              <th>Off-Peak</th>
              <th>Modifying</th>
            </tr>
          </thead>
          
          <tbody>
            <tr ng-repeat="variant in variants[tabnav].all | toArray | orderBy:'created'"
                ng-click="updateTargetFeature(variant);">
              <td>
                <i class="fa fa-square-o" 
                    ng-show="variants[tabnav].sel !== variant._key" 
                    ng-click="setSelectedVariant(tabnav, variant._key);
                              updateRouteScorecard(scenario[tabnav].routeId, tabnav);"></i>
                <i class="fa fa-check-square" 
                    ng-show="variants[tabnav].sel == variant._key"
                    ng-click="setSelectedVariant(tabnav, null);
                              updateRouteScorecard();"></i>
              </td>
              <td>{{ variant.name }}</td>
              <td>
                <span ng-if="variant.station == 0">
                  Standard 
                </span>
                <span ng-if="variant.station == 1">
                  Platform  
                </span>
                <span ng-if="variant.station == 2">
                  BRT Station 
                </span>
              </td>
              <td>
                {{ variant.peak.min | avgWaitTime }}
              </td>
              <td>
                {{ variant.offpeak.min | avgWaitTime }}
              </td>
              <td class="text-right">
                <span ng-show="scenario[tabnav].routeId !== variant.routeId"
                      ng-click="scenario[tabnav].routeId = variant.routeId; createVar=true">
                  <i class="fa fa-circle-o"></i>
                </span>
                <span ng-show="scenario[tabnav].routeId == variant.routeId">
                  <i class="fa fa-circle"></i>
                </span>
              </td>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <td>
                <i class="fa fa-sliders"></i>
              </td>
              <td><b>Current</b></td>
              <td>
                <span ng-if="scenario[tabnav].station == 0">
                  Standard 
                </span>
                <span ng-if="scenario[tabnav].station == 1">
                  Raised Platform  
                </span>
                <span ng-if="scenario[tabnav].station == 2">
                  BRT Station 
                </span>
              </td>
              <td>
                {{ scenario[tabnav].peak.min | avgWaitTime }}
              </td>
              <td>
                {{ scenario[tabnav].offpeak.min | avgWaitTime }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>



  <!-- 6 route editor module --> 
  <div class="colBody" style="width:275px">
    <div class="colHead" ng-click="visibleTabs.customize = !visibleTabs.customize">
      <i class="fa fa-pencil-square-o"></i> Service Editor
    </div>

    <div class="placeHolder" ng-show="!visibleTabs.customize" ng-click="visibleTabs.customize = !visibleTabs.customize">
      <div class="bigText">
        <i class="fa fa-pencil-square-o"></i>
      </div>
    </div>

    <div class="showToggle" ng-show="visibleTabs.customize">
      <div class="subHead">
        Set Average Wait Times
      </div>

      <div class="setTimesTitle">
        <input type="range" min="1" max="30" value="5" class="isosRange"
                      ng-model="scenario[tabnav].peak.min"
                      ng-click="updateOffPeakVal(scenario[tabnav].peak.min, tabnav);
                                updateRouteScorecard(scenario[tabnav].routeId, tabnav)"/>
        <h6>
          {{ scenario[tabnav].peak.min | avgWaitTime }}
          <small class="pull-right">Peak</small>
        </h6>

        <input type="range" min="1" max="30" value="10" class="isosRange"
                    ng-model="scenario[tabnav].offpeak.min"
                    ng-click="updateOffPeakVal(scenario[tabnav].peak.min, tabnav);
                              updateRouteScorecard(scenario[tabnav].routeId, tabnav)"/>    
        <h6>
          {{ scenario[tabnav].offpeak.min | avgWaitTime }}
          <small class="pull-right">Off-Peak</small>
        </h6>
      </div>

      <div class="bottomFixed">
        <div class="subHead">
          Station Type
        </div>

        <div class="btn-group btn-group-justified">
          <label  class="btn btn-xs btn-info" btn-radio="0"
                  ng-model="scenario[tabnav].station" 
                  ng-click="scenario[tabnav].station=0;
                            updateRouteScorecard(scenario[tabnav].routeId, tabnav)">
            Normal
          </label>
          <label  class="btn btn-xs btn-info" btn-radio="1"
                  ng-model="scenario[tabnav].station" 
                  ng-click="scenario[tabnav].station=1;
                            updateRouteScorecard(scenario[tabnav].routeId, tabnav)">
            Platform
          </label>
          <label  class="btn btn-xs btn-info" btn-radio="2"
                  ng-model="scenario[tabnav].station" 
                  ng-click="scenario[tabnav].station=2;
                            updateRouteScorecard(scenario[tabnav].routeId, tabnav)">
            BRT
          </label>
          <label class="btn btn-success" ng-click="saveAlt=true; createVar=false">
            <i class="fa fa-cloud-upload"></i> Save
          </label>
        </div>
      </div>
    </div>
  </div>

</div>

